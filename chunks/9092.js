"use strict";(self.webpackChunkberlin_equal_street_names=self.webpackChunkberlin_equal_street_names||[]).push([[9092],{39405:(t,e,i)=>{i.d(e,{EV:()=>r,ne:()=>o,nn:()=>h,yG:()=>n});var s=i(17321);function r(t,e){return{type:(0,s.UF)(e),value:t,unit:e}}function n(t,e){return{type:(0,s.UF)(e),value:t,unit:e}}function o(t,e){return{type:(0,s.UF)(e),value:t,unit:e}}function h(t,e){return r((0,s.En)(t.value,t.unit,e),e)}n(0,"meters")},6941:(t,e,i)=>{i.d(e,{Kc:()=>T,jB:()=>R});var s=i(44584),r=i(61681),n=i(76868),o=i(95550),h=i(55709),a=i(6766),c=i(8909),l=i(76169),d=i(86),p=i(36663),u=i(53443),g=i(81977),f=(i(7753),i(39994),i(7283),i(40266));i(56803);let _=t=>({vnodeSelector:"",properties:void 0,children:void 0,text:t.toString(),domNode:null}),x=(t,e,i)=>{for(let s=0,r=e.length;s<r;s++){let r=e[s];Array.isArray(r)?x(t,r,i):null!=r&&!1!==r&&("string"==typeof r&&(r=_(r)),i.push(r))}};function m(t,e,i){if(Array.isArray(e))i=e,e=void 0;else if(e&&("string"==typeof e||e.hasOwnProperty("vnodeSelector"))||i&&("string"==typeof i||i.hasOwnProperty("vnodeSelector")))throw new Error("h called with invalid arguments");let s,r;return i&&1===i.length&&"string"==typeof i[0]?s=i[0]:i&&(r=[],x(t,i,r),0===r.length&&(r=void 0)),{vnodeSelector:t,properties:e,children:r,text:""===s?void 0:s,domNode:null}}i(22591);let y=class extends u.Z{constructor(t){super(t),this.startX=0,this.startY=0,this.endX=0,this.endY=0,this.width=1,this.color=[0,0,0,.5],this.visible=!0}get startPosition(){return[this.startX,this.startY]}set startPosition(t){this._set("startX",t[0]),this._set("startY",t[1])}get endPosition(){return[this.endX,this.endY]}set endPosition(t){this._set("endX",t[0]),this._set("endY",t[1])}get strokeStyle(){const t=this.color;return`rgba(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]})`}get lineCap(){return"round"}render(){const{height:t,left:e,top:i,width:s,x1:r,x2:n,y1:o,y2:h}=this._calculateCoordinates(v),a=`stroke: ${this.strokeStyle}; stroke-width: ${this.width}; stroke-linecap: ${this.lineCap};`;return m("div",{classes:{"esri-line-overlay-item":!0},styles:{left:e+"px",top:i+"px",width:s+"px",height:t+"px",visibility:this.visible?"visible":"hidden"}},[m("svg",{width:s,height:t},[m("line",{x1:r,y1:o,x2:n,y2:h,style:a})])])}renderCanvas(t){if(!this.visible)return;t.strokeStyle=this.strokeStyle,t.lineWidth=this.width,t.lineCap=this.lineCap;const e=this._calculateCoordinates(v);t.beginPath(),t.moveTo(e.left+e.x1,e.top+e.y1),t.lineTo(e.left+e.x2,e.top+e.y2),t.stroke()}_calculateCoordinates(t){const e=Math.min(this.startX,this.endX),i=Math.max(this.startX,this.endX),s=Math.min(this.startY,this.endY),r=Math.max(this.startY,this.endY),n=this.width;return t.left=e-n,t.top=s-n,t.width=i-e+2*n,t.height=Math.max(20,r-s+2*n),t.x1=this.startX-e+n,t.y1=this.startY-s+n,t.x2=this.endX-e+n,t.y2=this.endY-s+n,t}};(0,p._)([(0,g.Cb)()],y.prototype,"startX",void 0),(0,p._)([(0,g.Cb)()],y.prototype,"startY",void 0),(0,p._)([(0,g.Cb)()],y.prototype,"endX",void 0),(0,p._)([(0,g.Cb)()],y.prototype,"endY",void 0),(0,p._)([(0,g.Cb)()],y.prototype,"startPosition",null),(0,p._)([(0,g.Cb)()],y.prototype,"endPosition",null),(0,p._)([(0,g.Cb)()],y.prototype,"width",void 0),(0,p._)([(0,g.Cb)()],y.prototype,"color",void 0),(0,p._)([(0,g.Cb)()],y.prototype,"visible",void 0),(0,p._)([(0,g.Cb)({readOnly:!0})],y.prototype,"strokeStyle",null),y=(0,p._)([(0,f.j)("esri.views.overlay.LineOverlayItem")],y);const v={left:0,top:0,width:0,height:0,x1:0,y1:0,x2:0,y2:0},V=y,E={bottom:"esri-text-overlay-item-anchor-bottom","bottom-right":"esri-text-overlay-item-anchor-bottom-right","bottom-left":"esri-text-overlay-item-anchor-bottom-left",top:"esri-text-overlay-item-anchor-top","top-right":"esri-text-overlay-item-anchor-top-right","top-left":"esri-text-overlay-item-anchor-top-left",center:"esri-text-overlay-item-anchor-center",right:"esri-text-overlay-item-anchor-right",left:"esri-text-overlay-item-anchor-left"};let b=class extends u.Z{constructor(t){super(t),this.x=0,this.y=0,this.text="-",this.fontSize=14,this.anchor="center",this.visible=!0,this._backgroundColor="rgba(0, 0, 0, 0.6)",this._textColor="white",this._textShadowColor=[0,0,0],this._textShadowSize=1}get position(){return[this.x,this.y]}set position(t){this._set("x",t[0]),this._set("y",t[1])}get _textShadow(){const[t,e,i]=this._textColor;return`0 0 ${this._textShadowSize}px rgb(${t}, ${e}, ${i})`}get _padding(){return.5*this.fontSize}get _borderRadius(){return this._padding}render(){return m("div",{classes:this._cssClasses(),styles:{left:Math.floor(this.x)+"px",top:Math.floor(this.y)+"px",visibility:this.visible?"visible":"hidden",fontSize:this.fontSize+"px",lineHeight:this.fontSize+"px",backgroundColor:this._backgroundColor,color:this._textColor,padding:this._padding+"px",borderRadius:this._borderRadius+"px",textShadow:this._textShadow}},[this.text])}renderCanvas(t){if(!this.visible)return;const e=t.font.replace(/^(.*?)px/,"");t.font=`${this.fontSize}px ${e}`;const i=this._padding,s=this._borderRadius,r=t.measureText(this.text).width,n=this.fontSize,o=S[this.anchor];t.textAlign="center",t.textBaseline="middle";const h=r+2*i,a=n+2*i,c=this.x+o.x*h,l=this.y+o.y*a;this._roundedRect(t,c,l,h,a,s),t.fillStyle=this._backgroundColor,t.fill();const d=this.x+(o.x+.5)*h,p=this.y+(o.y+.5)*a;this._renderTextShadow(t,this.text,d,p),t.fillStyle=this._textColor,t.fillText(this.text,d,p)}_renderTextShadow(t,e,i,s){t.lineJoin="miter",t.fillStyle=`rgba(${this._textShadowColor[0]}, ${this._textShadowColor[1]}, ${this._textShadowColor[2]}, ${1/C.length})`;const r=this._textShadowSize;for(const[n,o]of C)t.fillText(e,i+r*n,s+r*o)}_roundedRect(t,e,i,s,r,n){t.beginPath(),t.moveTo(e,i+n),t.arcTo(e,i,e+n,i,n),t.lineTo(e+s-n,i),t.arcTo(e+s,i,e+s,i+n,n),t.lineTo(e+s,i+r-n),t.arcTo(e+s,i+r,e+s-n,i+r,n),t.lineTo(e+n,i+r),t.arcTo(e,i+r,e,i+r-n,n),t.closePath()}_cssClasses(){const t={"esri-text-overlay-item":!0};for(const e in E)t[E[e]]=this.anchor===e;return t}};(0,p._)([(0,g.Cb)()],b.prototype,"x",void 0),(0,p._)([(0,g.Cb)()],b.prototype,"y",void 0),(0,p._)([(0,g.Cb)()],b.prototype,"position",null),(0,p._)([(0,g.Cb)()],b.prototype,"text",void 0),(0,p._)([(0,g.Cb)()],b.prototype,"fontSize",void 0),(0,p._)([(0,g.Cb)()],b.prototype,"anchor",void 0),(0,p._)([(0,g.Cb)()],b.prototype,"visible",void 0),(0,p._)([(0,g.Cb)()],b.prototype,"_backgroundColor",void 0),(0,p._)([(0,g.Cb)()],b.prototype,"_textColor",void 0),(0,p._)([(0,g.Cb)()],b.prototype,"_textShadowColor",void 0),(0,p._)([(0,g.Cb)()],b.prototype,"_textShadowSize",void 0),(0,p._)([(0,g.Cb)()],b.prototype,"_textShadow",null),(0,p._)([(0,g.Cb)()],b.prototype,"_padding",null),(0,p._)([(0,g.Cb)()],b.prototype,"_borderRadius",null),b=(0,p._)([(0,f.j)("esri.views.overlay.TextOverlayItem")],b);const S={bottom:{x:-.5,y:-1,textAlign:"center",textBaseline:"bottom"},"bottom-left":{x:0,y:-1,textAlign:"left",textBaseline:"bottom"},"bottom-right":{x:-1,y:-1,textAlign:"right",textBaseline:"bottom"},center:{x:-.5,y:-.5,textAlign:"center",textBaseline:"middle"},left:{x:0,y:-.5,textAlign:"left",textBaseline:"middle"},right:{x:-1,y:-.5,textAlign:"right",textBaseline:"middle"},top:{x:-.5,y:0,textAlign:"center",textBaseline:"top"},"top-left":{x:0,y:0,textAlign:"left",textBaseline:"top"},"top-right":{x:-1,y:0,textAlign:"right",textBaseline:"top"}},C=[];{const t=16;for(let e=0;e<360;e+=360/t)C.push([Math.cos(Math.PI*e/180),Math.sin(Math.PI*e/180)])}const w=b;class T extends l.l{constructor(t){super(t.view),this._handles=new s.Z,this._textItem=null,this._calloutItem=null,this._showCallout=!0,this._showText=!0,this._geometry=null,this._text="-",this._fontSize=14,this._distance=25,this._anchor="right",this.applyProps(t)}get geometry(){return this._geometry}set geometry(t){this._geometry=t,this._updateLabelPosition()}get textItem(){return this._textItem}get text(){return this._text}set text(t){this._text=t,this.attached&&(this._textItem.text=this._text)}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize=t,this.attached&&(this._textItem.fontSize=this._fontSize)}get distance(){return this._distance}set distance(t){this._distance!==t&&(this._distance=t,this._updateLabelPosition())}get anchor(){return this._anchor}set anchor(t){this._anchor!==t&&(this._anchor=t,this._updateLabelPosition())}overlaps(t){return!!this.attached&&this.textItem.visible&&t.textItem.visible&&this.view.overlay.overlaps(this._textItem,t.textItem)}_updateLabelPosition(){if(!this.attached)return;this._showText=!1,this._showCallout=!1;const{geometry:t,view:e,visible:i}=this;if((0,r.pC)(t)&&e._stage)switch(t.type){case"point":if(!this._computeLabelPositionFromPoint(t.point,L))break;if(t.callout){const i=e.state.camera,s=t.callout.distance;(0,h.b)(X,X,[0,t.callout.offset]),i.renderToScreen(X,L),(0,h.a)(z,0,1),(0,h.f)(z,z,s*i.pixelRatio),(0,h.b)(z,z,X),i.renderToScreen(z,Y),this._showCallout=this._updatePosition(L,Y)}else this._textItem.position=[L[0],L[1]],this._textItem.anchor="center";this._showText=!0;break;case"corner":if(!this._computeLabelPositionFromCorner(t,this._distance,L,Y))break;this._showCallout=this._updatePosition(L,Y),this._showText=!0;break;case"segment":{if(!this._computeLabelPositionFromSegment(t,this._distance,this._anchor,L,Y))break;this._showText=!0;const e=this._updatePosition(L,Y);this._showCallout=!1!==t.callout&&e,this._showCallout||(this._textItem.anchor="center")}}this.updateVisibility(i)}_computeLabelPositionFromPoint(t,e){const i=this.view.state.camera;return i.projectToRenderScreen(t,X),!(X[2]<0||X[2]>1||(i.renderToScreen(X,e),0))}_computeLabelPositionFromCorner(t,e,i,s){if(!t)return!1;const r=this.view.state.camera;return P(t.left,1,r,D),(0,h.n)(D,D),P(t.right,0,r,Z),(0,h.b)(z,D,Z),(0,h.n)(z,z),(0,h.i)(z,z),r.projectToRenderScreen(t.left.endRenderSpace,X),!(X[2]<0||X[2]>1||(r.renderToScreen(X,i),(0,h.f)(z,z,e*r.pixelRatio),(0,h.b)(z,z,X),r.renderToScreen(z,s),0))}_computeLabelPositionFromSegment(t,e,i,s,r){if(!t)return!1;const n=t.segment,o=this.view.state.camera;(0,d.CM)(n.startRenderSpace,n.endRenderSpace,o,D),(0,h.a)(z,-D[1],D[0]);let a=!1;switch(i){case"top":a=z[1]<0;break;case"bottom":a=z[1]>0;break;case"left":a=z[0]>0;break;case"right":a=z[0]<0}if(a&&(0,h.n)(z,z),0===(0,h.o)(z))switch(i){case"top":z[1]=1;break;case"bottom":z[1]=-1;break;case"left":z[0]=-1;break;case"right":z[0]=1}return n.eval(W[t.sampleLocation],k),o.projectToRenderScreen(k,X),!(X[2]<0||X[2]>1||(o.renderToScreen(X,s),(0,h.f)(z,z,e*o.pixelRatio),(0,h.b)(z,z,X),o.renderToScreen(z,r),0))}_updatePosition(t,e){if(e){const i=e[0]-t[0],s=e[1]-t[1];return this._textItem.position=[e[0],e[1]],this._textItem.anchor=Math.abs(i)>Math.abs(s)?i>0?"left":"right":s>0?"top":"bottom",this._calloutItem.startPosition=[t[0],t[1]],this._calloutItem.endPosition=[e[0],e[1]],!0}return this._textItem.position=[t[0],t[1]],this._textItem.anchor="center",!1}createResources(){this._textItem=new w({visible:!0,text:this._text,fontSize:this._fontSize}),this._calloutItem=new V({visible:!0,width:2}),this._updateLabelPosition(),this.view.overlay.items.addMany([this._textItem,this._calloutItem]),this._handles.add((0,n.YP)((()=>this.view.state.camera),(()=>this._updateLabelPosition())))}destroyResources(){this.view.overlay&&!this.view.overlay.destroyed&&this.view.overlay.items.removeMany([this._textItem,this._calloutItem]),this._handles.removeAll()}updateVisibility(t){this._textItem.visible=this._showText&&t,this._calloutItem.visible=this._showCallout&&t}}function P(t,e,i,s){t.eval(e,M,A),(0,a.a)(I,M,A),i.projectToRenderScreen(M,U),i.projectToRenderScreen(I,N),(0,h.g)(s,O,G),(0,h.i)(s,s)}function R(t){switch(t){case"top":return"bottom";case"right":return"left";case"bottom":return"top";case"left":return"right"}}const M=(0,c.c)(),I=(0,c.c)(),A=(0,c.c)(),D=(0,o.gX)(),Z=(0,o.gX)(),z=(0,o.gX)(),k=(0,c.c)(),X=(0,o.J$)(),L=(0,o.s1)(),Y=(0,o.s1)(),U=(0,o.J$)(),G=U,N=(0,o.J$)(),O=N,W={start:0,center:.5,end:1}},60033:(t,e,i)=>{i.d(e,{u4:()=>l,y$:()=>c});var s=i(6766),r=i(8909),n=i(90472),o=i(25726),h=i(68817),a=i(35369);class c{constructor(t=(0,r.c)(),e=(0,r.c)()){this.startRenderSpace=t,this.endRenderSpace=e,this.type="euclidean"}eval(t,e,i){return(0,s.h)(e,this.startRenderSpace,this.endRenderSpace,t),i&&((0,s.b)(i,this.endRenderSpace,this.startRenderSpace),(0,s.n)(i,i)),e}createRenderGeometry(t,e){const i=[],r=[],n=(e,n)=>{const o=p;(0,s.b)(o,e,t),i.push([o[0],o[1],o[2]]),r.push([n[0],n[1],n[2]])},o=e.worldUpAtPosition(this.eval(.5,d),h.WM.get());return n(this.startRenderSpace,o),n(this.endRenderSpace,o),{points:i,normals:r}}static fromPositionAndVector(t,e,i=1){return(0,s.g)(d,e,i),(0,s.a)(d,t,d),new c((0,r.a)(t),(0,r.a)(d))}}class l{constructor(t,e,i){this.startRenderSpace=t,this.endRenderSpace=e,this.renderSpatialReference=i,this.type="geodesic",this._start=(0,r.c)(),this._end=(0,r.c)(),this._pcpf=(0,o.rS)(i),this._project=(0,n.Up)(i,this._pcpf),this._projectIn(t,this._start),this._projectIn(e,this._end)}_projectIn(t,e){this._project?(0,n.SH)(t,this.renderSpatialReference,e,this._pcpf):(0,s.c)(e,t)}eval(t,e,i){if(this._project)if(i){const r=p;(0,a.ek)(this._start,this._end,t,e,r),(0,s.a)(u,e,r),(0,n.SH)(e,this._pcpf,e,this.renderSpatialReference),(0,n.SH)(u,this._pcpf,u,this.renderSpatialReference),(0,s.b)(i,u,e),(0,s.n)(i,i)}else(0,a.ZA)(this._start,this._end,t,e),(0,n.SH)(e,this._pcpf,e,this.renderSpatialReference);else(0,s.h)(e,this._start,this._end,t),i&&((0,s.b)(i,this._end,this._start),(0,s.n)(i,i));return e}createRenderGeometry(t,e){const i=[],r=[],n=(e,n)=>{const o=u;(0,s.b)(o,e,t),i.push([o[0],o[1],o[2]]),r.push([n[0],n[1],n[2]])};for(let t=0;t<128;++t){const i=t/127,s=d,r=p;this.eval(i,s),e.worldUpAtPosition(s,r),n(s,r)}return{points:i,normals:r}}}const d=(0,r.c)(),p=(0,r.c)(),u=(0,r.c)()},64594:(t,e,i)=>{i.d(e,{Y6:()=>f});var s,r,n=i(55709),o=i(69666),h=i(6766),a=i(8909),c=i(88589),l=i(1983),d=i(53446);(r=s||(s={}))[r.Z=0]="Z",r[r.M=1]="M";class p{constructor(t){this.spatialReference=t}createVector(){return this._tag((0,o.a)())}pointToVector(t){return this._tag((0,o.f)(t.x,t.y))}arrayToVector(t){return this._tag((0,o.f)(t[0],t[1]))}vectorToArray(t){return[t[0],t[1]]}pointToArray(t){return[t.x,t.y]}vectorToPoint(t,e=new d.Z){return e.x=t[0],e.y=t[1],e.z=void 0,e.m=void 0,e.spatialReference=this.spatialReference,e}arrayToPoint(t,e=new d.Z){return e.x=t[0],e.y=t[1],e.z=void 0,e.m=void 0,e.spatialReference=this.spatialReference,e}vectorToDehydratedPoint(t,e={x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,hasM:void 0,spatialReference:void 0,type:"point"}){return e.x=t[0],e.y=t[1],e.z=void 0,e.m=void 0,e.hasZ=!1,e.hasM=!1,e.spatialReference=this.spatialReference,e}lerp(t,e,i,s){return(0,n.l)(s,t,e,i)}addDelta(t,e,i){t[0]+=e,t[1]+=i}distance(t,e){return(0,n.j)(t,e)}getZ(t,e){return e}hasZ(){return!1}getM(t,e){return e}hasM(){return!1}clone(t){return this._tag((0,o.b)(t))}copy(t,e){return(0,n.c)(e,t)}fromXYZ(t){return this._tag((0,o.f)(t[0],t[1]))}toXYZ(t,e=0){return(0,a.f)(t[0],t[1],e)}_tag(t){return t}}class u{constructor(t,e){this.valueType=t,this.spatialReference=e}createVector(){return this._tag((0,a.c)())}pointToVector(t){return this._tag((0,a.f)(t.x,t.y,this.valueType===s.Z?t.z:t.m))}arrayToVector(t){return this._tag((0,a.f)(t[0],t[1],t[2]||0))}vectorToArray(t){return[t[0],t[1],t[2]]}pointToArray(t){return this.valueType===s.Z?[t.x,t.y,t.z]:[t.x,t.y,t.m]}vectorToPoint(t,e=new d.Z){return e.x=t[0],e.y=t[1],e.z=this.valueType===s.Z?t[2]:void 0,e.m=this.valueType===s.M?t[2]:void 0,e.spatialReference=this.spatialReference,e}arrayToPoint(t,e=new d.Z){return e.x=t[0],e.y=t[1],e.z=this.valueType===s.Z?t[2]:void 0,e.m=this.valueType===s.M?t[2]:void 0,e.spatialReference=this.spatialReference,e}vectorToDehydratedPoint(t,e={x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,hasM:void 0,spatialReference:void 0,type:"point"}){const i=this.valueType===s.Z,r=this.valueType===s.M;return e.x=t[0],e.y=t[1],e.z=i?t[2]:void 0,e.m=r?t[2]:void 0,e.hasZ=i,e.hasM=r,e.spatialReference=this.spatialReference,e}lerp(t,e,i,s){return(0,h.h)(s,t,e,i)}addDelta(t,e,i,r){t[0]+=e,t[1]+=i,this.valueType===s.Z&&(t[2]+=r)}distance(t,e){return this.valueType===s.Z?(0,h.i)(t,e):(0,n.j)(t,e)}getZ(t,e){return this.valueType===s.Z?t[2]:e}hasZ(){return this.valueType===s.Z}getM(t,e){return this.valueType===s.M?t[2]:e}hasM(){return this.valueType===s.M}clone(t){return this._tag((0,a.d)(t))}copy(t,e){return(0,h.c)(e,t)}fromXYZ(t,e=0,i=0){return this._tag((0,a.f)(t[0],t[1],this.valueType===s.Z?t.length>2?t[2]:e:i))}toXYZ(t,e=0){return this._tag((0,a.f)(t[0],t[1],this.valueType===s.Z?t[2]:e))}_tag(t){return t}}class g{constructor(t){this.spatialReference=t}createVector(){return this._tag((0,l.c)())}pointToVector(t){return this._tag((0,l.f)(t.x,t.y,t.z,t.m))}arrayToVector(t){return this._tag((0,l.f)(t[0],t[1],t[2]||0,t[3]||0))}vectorToArray(t){return[t[0],t[1],t[2],t[3]]}pointToArray(t){return[t.x,t.y,t.z,t.m]}vectorToPoint(t,e=new d.Z){return e.x=t[0],e.y=t[1],e.z=t[2],e.m=t[3],e.spatialReference=this.spatialReference,e}arrayToPoint(t,e=new d.Z){return e.x=t[0],e.y=t[1],e.z=t[2],e.m=t[3],e.spatialReference=this.spatialReference,e}vectorToDehydratedPoint(t,e={x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,hasM:void 0,spatialReference:void 0,type:"point"}){return e.x=t[0],e.y=t[1],e.z=t[2],e.m=t[3],e.hasZ=!0,e.hasM=!0,e.spatialReference=this.spatialReference,e}lerp(t,e,i,s){return(0,c.l)(s,t,e,i)}addDelta(t,e,i,s){t[0]+=e,t[1]+=i,t[2]+=s}distance(t,e){return(0,h.i)(t,e)}getZ(t){return t[2]}hasZ(){return!0}getM(t){return t[3]}hasM(){return!0}clone(t){return this._tag((0,l.b)(t))}copy(t,e){return(0,c.c)(e,t)}fromXYZ(t,e=0,i=0){return this._tag((0,l.f)(t[0],t[1],t.length>2?t[2]:e,i))}toXYZ(t){return(0,a.f)(t[0],t[1],t[2])}_tag(t){return t}}function f(t,e,i){return t&&e?new g(i):e?new u(s.M,i):t?new u(s.Z,i):new p(i)}},4703:(t,e,i)=>{i.d(e,{wA:()=>u,kS:()=>p,XE:()=>g,Xz:()=>d});var s=i(7753),r=i(31355),n=i(61681),o=i(89542),h=i(90819),a=i(64594),c=i(35925),l=i(65684);class d{constructor(t){this.component=t,this.leftEdge=null,this.rightEdge=null,this.type="vertex",this.index=null}get pos(){return this._pos}set pos(t){this._pos=t,this.component.unnormalizeVertexPositions()}}class p{constructor(t,e,i){this.component=t,this.leftVertex=e,this.rightVertex=i,this.type="edge",e.rightEdge=this,i.leftEdge=this}}class u{constructor(t,e){this.spatialReference=t,this.viewingMode=e,this.vertices=[],this.edges=[]}unnormalizeVertexPositions(){this.vertices.length<=1||function(t,e){if(!e.supported)return;let i=1/0,s=-1/0;const r=e.upperBoundX-e.lowerBoundX;t.forEach((t=>{let n=t.pos[0];for(;n<e.lowerBoundX;)n+=r;for(;n>e.upperBoundX;)n-=r;i=Math.min(i,n),s=Math.max(s,n),t.pos[0]=n}));const n=s-i;r-n<n&&t.forEach((t=>{t.pos[0]<0&&(t.pos[0]+=r)}))}(this.vertices,function(t,e){const i=(0,c.C5)(t);return e===l.JY.Global&&i?{supported:!0,lowerBoundX:i.valid[0],upperBoundX:i.valid[1]}:{supported:!1,lowerBoundX:null,upperBoundX:null}}(this.spatialReference,this.viewingMode))}updateVertexIndex(t,e){if(0===this.vertices.length)return;const i=this.vertices[0];let s=null,r=t,n=e;do{s=r,s.index=n++,r=s.rightEdge?s.rightEdge.rightVertex:null}while(null!=r&&r!==i);s.leftEdge&&s!==this.vertices[this.vertices.length-1]&&this.swapVertices(this.vertices.indexOf(s),this.vertices.length-1)}getFirstVertex(){return 0===this.vertices.length?null:this.vertices[0]}getLastVertex(){return 0===this.vertices.length?null:this.vertices[this.vertices.length-1]}isClosed(){return this.vertices.length>2&&null!==this.vertices[0].leftEdge}swapVertices(t,e){const i=this.vertices[t];this.vertices[t]=this.vertices[e],this.vertices[e]=i}iterateVertices(t){if(0===this.vertices.length)return;const e=this.vertices[0];let i=e;do{t(i,i.index),i=(0,n.pC)(i.rightEdge)?i.rightEdge.rightVertex:null}while(i!==e&&null!=i)}}class g extends r.Z{constructor(t,e){super(),this.type=t,this.coordinateHelper=e,this._geometry=null,this.dirty=!0,this.components=[]}get geometry(){if(this.dirty){switch(this.type){case"point":this._geometry=this._toPoint();break;case"polyline":this._geometry=this._toPolyline();break;case"polygon":this._geometry=this._toPolygon()}this.dirty=!1}return this._geometry}get spatialReference(){return this.coordinateHelper.spatialReference}notifyChanges(t){this.dirty=!0,this.emit("change",t)}_toPoint(){return 0===this.components.length||0===this.components[0].vertices.length?null:this.coordinateHelper.vectorToPoint(this.components[0].vertices[0].pos)}_toPolyline(){const t=[],e=this.coordinateHelper.vectorToArray;for(const i of this.components){if(i.vertices.length<1)continue;const s=[];let r=i.vertices.find((t=>null==t.leftEdge));const n=r;do{s.push(e(r.pos)),r=r.rightEdge?r.rightEdge.rightVertex:null}while(r&&r!==n);t.push(s)}return new h.Z({paths:t,spatialReference:this.spatialReference,hasZ:this.coordinateHelper.hasZ(),hasM:this.coordinateHelper.hasM()})}_toPolygon(){const t=[],e=this.coordinateHelper.vectorToArray;for(const i of this.components){if(i.vertices.length<1)continue;const s=[],r=i.vertices[0];let o=r;const h=o;do{s.push(e(o.pos)),o=(0,n.pC)(o.rightEdge)?o.rightEdge.rightVertex:null}while(o&&o!==h);i.isClosed()&&s.push(e(r.pos)),t.push(s)}return new o.Z({rings:t,spatialReference:this.spatialReference,hasZ:this.coordinateHelper.hasZ(),hasM:this.coordinateHelper.hasM()})}static fromGeometry(t,e){const i=t.spatialReference,r=(0,a.Y6)(t.hasZ,t.hasM,i),n=new g(t.type,r);switch(t.type){case"polygon":{const o=t.rings;for(let t=0;t<o.length;++t){const h=o[t],a=new u(i,e),c=h.length>2&&(0,s.fS)(h[0],h[h.length-1]),l=c?h.length-1:h.length;for(let t=0;t<l;++t){const e=r.arrayToVector(h[t]),i=new d(a);a.vertices.push(i),i.pos=e,i.index=t}const g=a.vertices.length-1;for(let t=0;t<g;++t){const e=a.vertices[t],i=a.vertices[t+1],s=new p(a,e,i);a.edges.push(s)}if(c){const t=new p(a,a.vertices[a.vertices.length-1],a.vertices[0]);a.edges.push(t)}n.components.push(a)}break}case"polyline":for(const s of t.paths){const t=new u(i,e),o=s.length;for(let e=0;e<o;++e){const i=r.arrayToVector(s[e]),n=new d(t);t.vertices.push(n),n.pos=i,n.index=e}const h=t.vertices.length-1;for(let e=0;e<h;++e){const i=t.vertices[e],s=t.vertices[e+1],r=new p(t,i,s);t.edges.push(r)}n.components.push(t)}break;case"point":{const s=new u(i,e),o=new d(s);o.index=0,o.pos=r.pointToVector(t),s.vertices.push(o),n.components.push(s);break}}return n}}},21739:(t,e,i)=>{i.d(e,{c:()=>I});var s,r,n=i(31355),o=i(61681),h=i(4703);!function(t){t[t.NEW_STEP=0]="NEW_STEP",t[t.ACCUMULATE_STEPS=1]="ACCUMULATE_STEPS"}(s||(s={}));class a{constructor(t,e,i){this.editGeometry=t,this.component=e,this.pos=i,this.addedVertex=null,this.originalEdge=null,this.left=null,this.right=null}apply(){let t="redo";(0,o.Wi)(this.addedVertex)&&(t="apply",this.addedVertex=new h.Xz(this.component));const e=this.component.getLastVertex();if((0,o.Wi)(e))this.component.vertices.push(this.addedVertex),this.addedVertex.pos=this.pos,this.addedVertex.index=0;else{let t=null;e.rightEdge&&(this.originalEdge=e.rightEdge,t=this.originalEdge.rightVertex,this.component.edges.splice(this.component.edges.indexOf(this.originalEdge),1)),this.component.vertices.push(this.addedVertex),this.addedVertex.pos=this.pos,(0,o.Wi)(this.left)&&(this.left=new h.kS(this.component,e,this.addedVertex)),this.component.edges.push(this.left),e.rightEdge=this.left,(0,o.pC)(this.originalEdge)&&(0,o.pC)(t)&&((0,o.Wi)(this.right)&&(this.right=new h.kS(this.component,this.addedVertex,t)),this.component.edges.push(this.right),t.leftEdge=this.right),this.component.updateVertexIndex(this.addedVertex,e.index+1)}this.editGeometry.notifyChanges({operation:t,addedVertices:[this.addedVertex]})}undo(){if((0,o.Wi)(this.addedVertex))return null;this.component.vertices.splice(this.component.vertices.indexOf(this.addedVertex),1),(0,o.pC)(this.left)&&(this.component.edges.splice(this.component.edges.indexOf(this.left),1),this.left.leftVertex.rightEdge=null),(0,o.pC)(this.right)&&(this.component.edges.splice(this.component.edges.indexOf(this.right),1),this.right.rightVertex.leftEdge=null),(0,o.pC)(this.originalEdge)&&(this.component.edges.push(this.originalEdge),this.originalEdge.leftVertex.rightEdge=this.originalEdge,this.originalEdge.rightVertex.leftEdge=this.originalEdge),(0,o.pC)(this.left)?this.component.updateVertexIndex(this.left.leftVertex,this.left.leftVertex.index):this.component.updateVertexIndex(this.addedVertex,0),this.editGeometry.notifyChanges({operation:"undo",removedVertices:[this.addedVertex]})}accumulate(){return!1}}class c{constructor(t,e,i){this.editGeometry=t,this.vertices=e,this.operation=i,this.undone=!1}apply(){this.vertices.forEach((t=>this.operation.apply(t))),this.editGeometry.components.forEach((t=>t.unnormalizeVertexPositions())),this.editGeometry.notifyChanges({operation:this.undone?"redo":"apply",updatedVertices:this.vertices})}undo(){this.vertices.forEach((t=>this.operation.undo(t))),this.editGeometry.notifyChanges({operation:"undo",updatedVertices:this.vertices}),this.undone=!0}canAccumulate(t){if(this.undone||t.vertices.length!==this.vertices.length)return!1;for(let e=0;e<t.vertices.length;++e)if(t.vertices[e]!==this.vertices[e])return!1;return this.operation.canAccumulate(t.operation)}accumulate(t){return!!(t instanceof c&&this.canAccumulate(t))&&(this.vertices.forEach((e=>this.operation.accumulate(e,t.operation))),this.operation.accumulateParams(t.operation),this.editGeometry.components.forEach((t=>t.unnormalizeVertexPositions())),this.editGeometry.notifyChanges({operation:"apply",updatedVertices:this.vertices}),!0)}}!function(t){t[t.CUMULATIVE=0]="CUMULATIVE",t[t.REPLACE=1]="REPLACE"}(r||(r={}));class l{constructor(t,e,i=0){this.editGeometry=t,this.vertices=e,this.minNumberOfVertices=i,this.removedVertices=null}apply(){let t="redo";null==this.removedVertices?(this.removedVertices=[],this.vertices.forEach((t=>{const e=this._removeVertex(t);(0,o.pC)(e)&&this.removedVertices.push(e)})),t="apply"):this.removedVertices.forEach((t=>{this._removeVertex(t.removedVertex)})),this.editGeometry.notifyChanges({operation:t,removedVertices:this.vertices})}undo(){this.removedVertices.forEach((t=>{this._undoRemoveVertex(t)})),this.editGeometry.notifyChanges({operation:"undo",addedVertices:this.vertices})}accumulate(){return!1}_removeVertex(t){const e=t.component;if(e.vertices.length<=this.minNumberOfVertices)return null;const i={removedVertex:t,createdEdge:null},s=t.leftEdge,r=t.rightEdge;return e.vertices.splice(e.vertices.indexOf(t),1),s&&(e.edges.splice(e.edges.indexOf(s),1),s.leftVertex.rightEdge=null),r&&(e.edges.splice(e.edges.indexOf(r),1),r.rightVertex.leftEdge=null),0===t.index&&r&&this.vertices.length>0&&e.swapVertices(e.vertices.indexOf(r.rightVertex),0),s&&r&&(i.createdEdge=new h.kS(e,s.leftVertex,r.rightVertex),e.edges.push(i.createdEdge)),r&&e.updateVertexIndex(r.rightVertex,r.rightVertex.index-1),i}_undoRemoveVertex(t){const e=t.removedVertex,i=t.removedVertex.component,s=e.leftEdge,r=e.rightEdge;t.createdEdge&&i.edges.splice(i.edges.indexOf(t.createdEdge),1),i.vertices.push(e),s&&(i.edges.push(s),s.leftVertex.rightEdge=s),r&&(i.edges.push(r),r.rightVertex.leftEdge=r),i.updateVertexIndex(e,e.index)}}class d{constructor(t,e,i){this.editGeometry=t,this.edge=e,this.t=i,this.createdVertex=null,this.left=null,this.right=null}apply(){let t="redo";const e=this.edge,i=e.component,s=e.leftVertex,r=e.rightVertex;i.edges.splice(i.edges.indexOf(e),1),(0,o.Wi)(this.createdVertex)&&(t="apply",this.createdVertex=new h.Xz(e.component)),i.vertices.push(this.createdVertex),this.createdVertex.pos=this.editGeometry.coordinateHelper.lerp(e.leftVertex.pos,e.rightVertex.pos,this.t,this.editGeometry.coordinateHelper.createVector()),(0,o.Wi)(this.left)&&(this.left=new h.kS(i,s,this.createdVertex)),this.left.leftVertex.leftEdge?i.edges.push(this.left):i.edges.unshift(this.left),s.rightEdge=this.left,(0,o.Wi)(this.right)&&(this.right=new h.kS(i,this.createdVertex,r)),i.edges.push(this.right),r.leftEdge=this.right,i.updateVertexIndex(this.createdVertex,s.index+1),this.editGeometry.notifyChanges({operation:t,addedVertices:[this.createdVertex]})}undo(){if((0,o.Wi)(this.createdVertex)||(0,o.Wi)(this.left)||(0,o.Wi)(this.right))return null;const t=this.edge,e=t.component,i=this.createdVertex.leftEdge,s=this.createdVertex.rightEdge,r=i.leftVertex,n=s.rightVertex;e.vertices.splice(e.vertices.indexOf(this.createdVertex),1),e.edges.splice(e.edges.indexOf(this.left),1),e.edges.splice(e.edges.indexOf(this.right),1),this.edge.leftVertex.leftEdge?e.edges.push(this.edge):e.edges.unshift(this.edge),r.rightEdge=t,n.leftEdge=t,e.updateVertexIndex(r,r.index),this.editGeometry.notifyChanges({operation:"undo",removedVertices:[this.createdVertex]})}accumulate(){return!1}}class p{constructor(t,e,i){this.editGeometry=t,this.vertex=e,this.pos=i}apply(){const t=(0,o.Wi)(this.originalPosition);t&&(this.originalPosition=this.vertex.pos),this._apply(t?"apply":"redo")}undo(){this.vertex.pos=(0,o.Wg)(this.originalPosition),this.editGeometry.notifyChanges({operation:"undo",updatedVertices:[this.vertex]})}accumulate(t){return t instanceof p&&t.vertex===this.vertex&&(this.pos=t.pos,this._apply("apply"),!0)}_apply(t){this.vertex.pos=this.pos,this.editGeometry.components.forEach((t=>t.unnormalizeVertexPositions())),this.editGeometry.notifyChanges({operation:t,updatedVertices:[this.vertex]})}}var u=i(7753);class g{constructor(t,e){this.editGeometry=t,this.component=e,this.createdEdge=null}apply(){let t="redo";if((0,o.Wi)(this.createdEdge)){t="apply";const e=this.component.getFirstVertex(),i=this.component.getLastVertex();if(this.component.isClosed()||this.component.vertices.length<3||(0,o.Wi)(e)||(0,o.Wi)(i))return;this.createdEdge=new h.kS(this.component,i,e)}this.createdEdge.leftVertex.rightEdge=this.createdEdge,this.createdEdge.rightVertex.leftEdge=this.createdEdge,this.component.edges.push(this.createdEdge),this.editGeometry.notifyChanges({operation:t})}undo(){(0,o.Wi)(this.createdEdge)||((0,u.Od)(this.component.edges,this.createdEdge),this.createdEdge.leftVertex.rightEdge=null,this.createdEdge.rightVertex.leftEdge=null,this.editGeometry.notifyChanges({operation:"undo"}))}accumulate(){return!1}}class f{constructor(t,e,i,s){this.helper=t,this.dx=e,this.dy=i,this.dz=s}_move(t,e,i,s){this.helper.addDelta(t.pos,e,i,s)}apply(t){this._move(t,this.dx,this.dy,this.dz)}undo(t){this._move(t,-this.dx,-this.dy,-this.dz)}canAccumulate(t){return t instanceof f}accumulate(t,e){this._move(t,e.dx,e.dy,e.dz)}accumulateParams(t){this.dx+=t.dx,this.dy+=t.dy,this.dz+=t.dz}}var _=i(19431),x=i(55709),m=i(69666),y=i(6766),v=i(8909),V=i(69430),E=i(5700),b=i(23440);class S{constructor(t,e,i,s=0,r=T.IMMEDIATE){this.helper=t,this.planeType=e,this.edge=i,this.distance=s,this._plane=(0,V.Ue)(),this._offsetPlane=(0,V.Ue)(),this._minDistance=-1/0,this._maxDistance=1/0,r===T.IMMEDIATE&&this._initialize()}get plane(){return this._plane}get requiresSplitEdgeLeft(){return!this._left.isOriginalDirection}get requiresSplitEdgeRight(){return!this._right.isOriginalDirection}get edgeDirection(){return this._edgeDirection}_initialize(){this._initializeNeighbors(),this._initializePlane(),this._initializeDistanceConstraints()}_initializeNeighbors(){const t=this._toXYZ(this.edge.leftVertex.pos),e=this._toXYZ(this.edge.leftVertex.leftEdge?.leftVertex?.pos),i=this._toXYZ(this.edge.rightVertex.pos),s=this._toXYZ(this.edge.rightVertex.rightEdge?.rightVertex?.pos);this._edgeDirection=(0,y.r)((0,v.c)(),t,i),this._left=this._computeNeighbor(t,e,this._edgeDirection),this._right=this._computeNeighbor(i,s,this._edgeDirection)}_toXYZ(t){return(0,o.pC)(t)?this.helper.toXYZ(t):null}_computeNeighbor(t,e,i){if((0,o.Wi)(e))return{start:t,end:e,direction:(0,v.f)(-i[1],i[0],0),isOriginalDirection:!0};const s=(0,y.r)((0,v.c)(),t,e),r=!this._passesBisectingAngleThreshold(s,i);return{start:t,end:e,direction:r?this._bisectVectorsPerpendicular(i,s):s,isOriginalDirection:!r}}_passesBisectingAngleThreshold(t,e){const i=Math.abs((0,E.EU)(e,t));return i>=C&&i<=Math.PI-C}_bisectVectorsPerpendicular(t,e){const i=(0,y.e)(t,e)<0?t:(0,y.o)((0,v.c)(),t),s=Math.abs((0,y.e)(i,e));if(!(s<.001||s>.999))return this._bisectDirection(i,e);const r=(0,y.f)((0,v.c)(),i,[0,0,1]);return(0,y.n)(r,r)}_bisectDirection(t,e){const i=(0,y.a)((0,v.c)(),t,e);return(0,y.n)(i,i)}_initializePlane(){const t=this._computeNormalDirection(this._left),e=this._computeNormalDirection(this._right);(0,y.e)(t,e)<0&&(0,y.o)(e,e),(0,V.Yq)(this._left.start,this._bisectDirection(t,e),this._plane)}_computeNormalDirection(t){const e=(0,y.f)((0,v.c)(),t.direction,this._edgeDirection);(0,y.n)(e,e);const i=(0,y.f)((0,v.c)(),this._edgeDirection,e);return this.planeType===w.XY&&(i[2]=0),(0,y.n)(i,i)}_initializeDistanceConstraints(){(0,o.pC)(this._left.end)&&!this.requiresSplitEdgeLeft&&this._updateDistanceConstraint((0,V.jH)(this._plane,this._left.end)),(0,o.pC)(this._right.end)&&!this.requiresSplitEdgeRight&&this._updateDistanceConstraint((0,V.jH)(this._plane,this._right.end)),this._updateIntersectDistanceConstraint(this._plane)}_updateDistanceConstraint(t){t<=0&&(this._minDistance=Math.max(this._minDistance,t)),t>=0&&(this._maxDistance=Math.min(this._maxDistance,t))}_updateIntersectDistanceConstraint(t){const e=(0,V.mJ)(t),i=this._edgeDirection,s=(0,y.a)((0,v.c)(),this._left.start,this._left.direction),r=(0,y.a)((0,v.c)(),this._right.start,this._right.direction),n=this._pointInBasis2D((0,m.a)(),e,i,this._left.start),o=this._pointInBasis2D((0,m.a)(),e,i,s),h=this._pointInBasis2D((0,m.a)(),e,i,this._right.start),a=this._pointInBasis2D((0,m.a)(),e,i,r),[c]=(0,b.dU)({start:o,end:n,type:b.SP.LINE},{start:a,end:h,type:b.SP.LINE});if(!c)return;const l=(0,x.g)((0,m.a)(),n,o);(0,x.i)(l,l);const d=(0,x.g)((0,m.a)(),c,o),p=(0,x.h)(l,d),u=(0,y.a)((0,v.c)(),s,(0,y.g)((0,v.c)(),this._left.direction,-p)),g=(0,V.jH)(t,u);this._updateDistanceConstraint(g)}_pointInBasis2D(t,e,i,s){return t[0]=(0,E.SR)(e,s),t[1]=(0,E.SR)(i,s),t}_offset(t,e){Number.isFinite(this._minDistance)&&(e=Math.max(this._minDistance,e)),Number.isFinite(this._maxDistance)&&(e=Math.min(this._maxDistance,e)),(0,V.JG)(this._offsetPlane,this._plane),this._offsetPlane[3]-=e;const i=(t,e,i)=>(0,o.pC)(e)&&(0,V.fn)(this._offsetPlane,t,(0,y.a)((0,v.c)(),t,e),i),s=(0,v.c)();(t===this.edge.leftVertex?i(this._left.start,this._left.direction,s):i(this._right.start,this._right.direction,s))&&this.helper.copy(this.helper.fromXYZ(s,void 0,this.helper.getM(t.pos)),t.pos)}signedDistanceToPoint(t){return(0,V.jH)(this.plane,this.helper.toXYZ(this.helper.pointToVector(t)))}apply(t){this._offset(t,this.distance)}undo(t){this._offset(t,0)}canAccumulate(t){return t instanceof S&&this.edge.leftVertex.index===t.edge.leftVertex.index&&this.edge.rightVertex.index===t.edge.rightVertex.index&&this.edge.component===t.edge.component&&this._maybeEqualsVec3(this._left.direction,t._left.direction)&&this._maybeEqualsVec3(this._right.direction,t._right.direction)&&(0,y.z)((0,V.mJ)(this._plane),(0,V.mJ)(t._plane))}accumulate(t,e){const i=this._plane[3]-e._plane[3]+e.distance;this._offset(t,i)}accumulateParams(t){const e=t.distance-t._plane[3];this.distance=e+this._plane[3]}clone(){const t=new S(this.helper,this.planeType,this.edge,this.distance,T.DEFERRED);return(0,V.JG)(t._plane,this._plane),(0,V.JG)(t._offsetPlane,this._offsetPlane),t._maxDistance=this._maxDistance,t._minDistance=this._minDistance,t._left=this._cloneNeighbor(this._left),t._right=this._cloneNeighbor(this._right),t._edgeDirection=(0,y.c)((0,v.c)(),this._edgeDirection),t}_maybeEqualsVec3(t,e){return(0,o.Wi)(t)&&(0,o.Wi)(e)||(0,o.pC)(t)&&(0,o.pC)(e)&&(0,y.z)(t,e)}_cloneNeighbor({start:t,end:e,direction:i,isOriginalDirection:s}){return{start:(0,y.c)((0,v.c)(),t),end:(0,o.pC)(e)?(0,y.c)((0,v.c)(),e):null,direction:(0,y.c)((0,v.c)(),i),isOriginalDirection:s}}}const C=(0,_.Vl)(15);var w,T;!function(t){t[t.XYZ=0]="XYZ",t[t.XY=1]="XY"}(w||(w={})),function(t){t[t.IMMEDIATE=0]="IMMEDIATE",t[t.DEFERRED=1]="DEFERRED"}(T||(T={}));class P{constructor(t,e,i=r.CUMULATIVE){this.origin=t,this.angle=e,this.accumulationType=i}_rotate(t,e){(0,x.r)(t.pos,t.pos,this.origin,e)}apply(t){this._rotate(t,this.angle)}undo(t){this._rotate(t,-this.angle)}canAccumulate(t){return t instanceof P&&(0,u.fS)(this.origin,t.origin)}accumulate(t,e){const i=e.accumulationType===r.REPLACE;this._rotate(t,i?e.angle-this.angle:e.angle)}accumulateParams(t){const e=t.accumulationType===r.REPLACE;this.angle=e?t.angle:this.angle+t.angle}}class R{constructor(t,e,i,s,n=r.CUMULATIVE){this.origin=t,this.axis1=e,this.factor1=i,this.factor2=s,this.accumulationType=n,this.axis2=(0,m.f)(e[1],-e[0])}_scale(t,e,i){(0,x.q)(t.pos,t.pos,this.origin,this.axis1,e),(0,x.q)(t.pos,t.pos,this.origin,this.axis2,i)}apply(t){this._scale(t,this.factor1,this.factor2)}undo(t){this._scale(t,1/this.factor1,1/this.factor2)}canAccumulate(t){return t instanceof R&&(0,u.fS)(this.origin,t.origin)&&(0,u.fS)(this.axis1,t.axis1)}accumulate(t,e){e.accumulationType===r.REPLACE?this._scale(t,e.factor1/this.factor1,e.factor2/this.factor2):this._scale(t,e.factor1,e.factor2)}accumulateParams(t){const e=t.accumulationType===r.REPLACE;this.factor1=e?t.factor1:this.factor1*t.factor1,this.factor2=e?t.factor2:this.factor2*t.factor2}}class M{constructor(){this.operations=[],this.closed=!1}close(){this.closed=!0}apply(){for(const t of this.operations)t.apply()}undo(){for(let t=this.operations.length-1;t>=0;t--)this.operations[t].undo()}accumulate(t){if(this.closed)return!1;const e=this.operations.length?this.operations[this.operations.length-1]:null;return e&&e.accumulate(t)||(this.operations.push(t),t.apply()),!0}}class I extends n.Z{constructor(t){super(),this.data=t,this.undoStack=[],this.redoStack=[],this.listener=this.data.on("change",(t=>{t.addedVertices&&this.emit("vertex-add",{type:"vertex-add",vertices:t.addedVertices,operation:t.operation}),t.removedVertices&&this.emit("vertex-remove",{type:"vertex-remove",vertices:t.removedVertices,operation:t.operation}),t.updatedVertices&&this.emit("vertex-update",{type:"vertex-update",vertices:t.updatedVertices,operation:t.operation})}))}destroy(){this.listener.remove()}splitEdge(t,e){return this._apply(new d(this.data,t,e))}updateVertices(t,e,i=s.ACCUMULATE_STEPS){return this._apply(new c(this.data,t,e),i)}moveVertices(t,e,i,r,n=s.ACCUMULATE_STEPS){return this.updateVertices(t,new f(this.data.coordinateHelper,e,i,r),n)}scaleVertices(t,e,i,n,o,h=s.ACCUMULATE_STEPS,a=r.CUMULATIVE){return this.updateVertices(t,new R(e,i,n,o,a),h)}rotateVertices(t,e,i,n=s.ACCUMULATE_STEPS,o=r.CUMULATIVE){return this.updateVertices(t,new P(e,i,o),n)}removeVertices(t){return this._apply(new l(this.data,t,this._minNumVerticesPerType))}appendVertex(t){return 0===this.data.components.length?null:this._apply(new a(this.data,this.data.components[0],t))}setVertexPosition(t,e){return this._apply(new p(this.data,t,e))}offsetEdge(t,e,i,r=s.ACCUMULATE_STEPS){return this.updateVertices([e.leftVertex,e.rightVertex],new S(this.data.coordinateHelper,t,e,i),r)}closeComponent(t){return this.data.components.includes(t)?this._apply(new g(this.data,t)):null}canRemoveVertex(){return this.data.components[0].vertices.length>this._minNumVerticesPerType}createUndoGroup(){const t=new M;return this._apply(t),{remove:()=>t.close()}}undo(){if(this.undoStack.length>0){const t=this.undoStack.pop();return t.undo(),this.redoStack.push(t),t}return null}redo(){if(this.redoStack.length>0){const t=this.redoStack.pop();return t.apply(),this.undoStack.push(t),t}return null}get canUndo(){return this.undoStack.length>0}get canRedo(){return this.redoStack.length>0}get lastOperation(){return this.undoStack.length>0?this.undoStack[this.undoStack.length-1]:null}get _minNumVerticesPerType(){switch(this.data.type){case"point":return 1;case"polyline":return 2;case"polygon":return 3;default:return 0}}_apply(t,e=s.ACCUMULATE_STEPS){return e!==s.NEW_STEP&&!(0,o.Wi)(this.lastOperation)&&this.lastOperation.accumulate(t)||(t.apply(),this.undoStack.push(t),this.redoStack=[]),t}static fromGeometry(t,e){return new I(h.XE.fromGeometry(t,e))}}},86:(t,e,i)=>{i.d(e,{$r:()=>c,By:()=>d,CM:()=>a,a7:()=>l});var s=i(95550),r=i(55709),n=(i(6766),i(8909)),o=i(53446),h=i(83772);function a(t,e,i,s){i.projectToRenderScreen(t,g),i.projectToRenderScreen(e,f),(0,r.g)(s,f,g),(0,r.i)(s,s)}function c(t,e,i,s,r=(0,n.c)()){const o=e.toXYZ(t);return o[2]=(0,h.zx)(s,o,e.spatialReference,i)||0,s.renderCoordsHelper.toRenderCoords(o,e.spatialReference,r),r}function l(t,e,i,r){return"2d"===r.type?r.toScreen(e.vectorToPoint(t,p)):(c(t,e,i,r,u),r.state.camera.projectToScreen(u,_),(0,s.vW)(_[0],_[1]))}function d(t,e,i,s,r,n,o){const a=i.toXYZ(t),c=i.toXYZ(e);if("absolute-height"!==s.mode){const t=(0,h.zx)(r,a,i.spatialReference,s),e=(0,h.zx)(r,c,i.spatialReference,s),n=(null==t?e:null==e?t:Math.min(t,e))||0;a[2]=n,c[2]=n}r.renderCoordsHelper.toRenderCoords(a,i.spatialReference,n),r.renderCoordsHelper.toRenderCoords(c,i.spatialReference,o)}const p=new o.Z,u=(0,n.c)(),g=(0,s.J$)(),f=(0,s.J$)(),_=(0,s.s1)();(0,s.s1)()},23440:(t,e,i)=>{i.d(e,{Oy:()=>c,SP:()=>s,UG:()=>_,aW:()=>d,dU:()=>f,k0:()=>l,l0:()=>g,pk:()=>u,xO:()=>p});var s,r,n=i(19431),o=i(55709),h=i(69666);function a(t,e){return t[0]*e[1]-t[1]*e[0]}function c(t,e,i){const s=(e[0]-t[0])*(i[1]-t[1])-(e[1]-t[1])*(i[0]-t[0]);return Math.abs(s)/(0,o.j)(e,i)}function l(t,e,i,s,r=i){return(0,o.g)(m,s,i),(0,o.g)(v,e,r),function(t,e,i){const s=(0,o.h)(i,e)/(0,o.u)(i);(0,o.f)(t,i,s)}(V,v,m),(0,o.b)(t,r,V)}function d(t,e,i,s){(0,o.g)(m,s,i),(0,o.g)(v,e,i);const r=(0,o.h)(m,v)/(0,o.u)(m);return r>0?(0,o.v)(t,i,m,r):(0,o.c)(t,i)}function p(t,e,i,s){(0,o.g)(m,e,i);const r=s/(0,o.o)(m);return(0,o.v)(t,i,m,r)}function u(t,e){return l(v,e,t.start,t.end),(0,n.W8)(v[0],e[0])&&(0,n.W8)(v[1],e[1])?[(0,h.d)(e)]:[]}function g(t,e,i){return p(v,i,t,e),(0,n.W8)(v[0],i[0])&&(0,n.W8)(v[1],i[1])?[(0,h.d)(i)]:[]}function f(t,e){const i=t.start,r=t.end,n=e.start,h=e.end,c=(0,o.g)(m,r,i),l=(0,o.g)(y,h,n),d=a(c,l);if(Math.abs(d)<=x)return[];const p=(0,o.g)(v,i,n),u=a(l,p)/d,g=a(c,p)/d;if(u>=0){if(g>=0||e.type===s.LINE)return[(0,o.v)(V,i,c,u)]}else if(t.type===s.LINE&&(g>=0||e.type===s.LINE))return[(0,o.v)(V,i,c,u)];return[]}function _(t,e,i){const r=[],n=(0,o.g)(m,t.end,t.start),h=(0,o.g)(y,t.start,e),a=(0,o.u)(n),c=2*(0,o.h)(n,h),l=c*c-4*a*((0,o.u)(h)-i*i);if(0===l){const e=-c/(2*a);(t.type===s.LINE||e>=0)&&r.push((0,o.v)(V,t.start,n,e))}else if(l>0){const e=Math.sqrt(l),i=(-c+e)/(2*a);(t.type===s.LINE||i>=0)&&r.push((0,o.v)(V,t.start,n,i));const h=(-c-e)/(2*a);(t.type===s.LINE||h>=0)&&r.push((0,o.v)(v,t.start,n,h))}return r}(r=s||(s={}))[r.RAY=0]="RAY",r[r.LINE=1]="LINE";const x=1e-6,m=(0,h.a)(),y=(0,h.a)(),v=(0,h.a)(),V=(0,h.a)()},89976:(t,e,i)=>{i.d(e,{m:()=>n});var s=i(90472),r=i(25726);function n(t){const e=(0,r.rS)(t),i=e===r.GG?r.wY:e;return(0,s.Up)(t,i)?i:t}}}]);